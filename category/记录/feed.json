{
    "version": "https://jsonfeed.org/version/1",
    "title": "uyume的记录本 • All posts by \"记录\" category",
    "description": "记录想法和闲言碎语",
    "home_page_url": "http://yuan-uyume.github.io",
    "items": [
        {
            "id": "http://yuan-uyume.github.io/2023/08/27/records/shokax%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/",
            "url": "http://yuan-uyume.github.io/2023/08/27/records/shokax%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/",
            "title": "shokaX插件开发记录",
            "date_published": "2023-08-27T03:59:58.000Z",
            "content_html": "<h1 id=\"插件列表\"><a class=\"markdownIt-Anchor\" href=\"#插件列表\">#</a> 插件列表</h1>\n<ul>\n<li>在文章开头自动添加过期和网络异常警告 （shokax 插件）</li>\n</ul>\n<h2 id=\"在文章开头自动添加过期和网络异常警告\"><a class=\"markdownIt-Anchor\" href=\"#在文章开头自动添加过期和网络异常警告\">#</a> 在文章开头自动添加过期和网络异常警告</h2>\n<p>效果图：<br>\n<img data-src=\"https://raw.githubusercontent.com/yuan-uyume/imghub/master/%E5%9B%BE%20shokax%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95%20-%201693117019995%20-%20%24%7Bindex%7D.png\" alt=\"图 shokax插件开发记录 - 1693117021438 - 0\"></p>\n<p><code>inject</code>  文件如下 (路径：<strong>hexo\\scripts\\inject.js</strong>)：</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hexo<span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'theme_inject'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">injects</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    injects<span class=\"token punctuation\">.</span>postBodyEnd<span class=\"token punctuation\">.</span><span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post_notice'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'views/notice.pug'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>notice.pug</code>  文件如下 (路径：<strong>hexo\\views\\notice.pug</strong>)</p>\n<figure class=\"highlight pug\"><figcaption data-lang=\"pug\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\">script</span><span class=\"token punctuation\">.</span><span class=\"token multiline-script\"></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> addData <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;div class=\"note warning\">'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        addData <span class=\"token operator\">=</span> <span class=\"token function\">addNetErrWaring</span><span class=\"token punctuation\">(</span>addData<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        addData <span class=\"token operator\">=</span> <span class=\"token function\">addLostWaring</span><span class=\"token punctuation\">(</span>addData<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        addData <span class=\"token operator\">+=</span> <span class=\"token string\">\"&lt;/div>\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">let</span> adom <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        adom<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">'md'</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        adom<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> addData</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        posts<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>adom<span class=\"token punctuation\">,</span> posts<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">addNetErrWaring</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">addData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">return</span> addData <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;p style=\"color: #e9546b\">因网络问题只有具有魔法资质的人才能看见完整的全部内容哦~ 勇敢的你快成为魔法少女吧！&lt;/p>'</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">addLostWaring</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">addData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">const</span> times <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'time'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>times<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">const</span> pubTime <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>times<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dateTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">/* 文章发布时间戳 */</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">const</span> now <span class=\"token operator\">=</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">/* 当前时间戳 */</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">const</span> interval <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>now <span class=\"token operator\">-</span> pubTime<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">/* 发布时间超过指定时间（毫秒） */</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>interval <span class=\"token operator\">></span> <span class=\"token number\">3600</span><span class=\"token operator\">*</span><span class=\"token number\">24</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token operator\">*</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token keyword\">const</span> days <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>interval <span class=\"token operator\">/</span> <span class=\"token number\">86400000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">return</span> addData <span class=\"token operator\">+</span> </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;p></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            &lt;div class=\"h6\">文章时效性提示&lt;/div></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            &lt;p>这是一篇发布于 </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span> days <span class=\"token operator\">+</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> 天前的文章，部分信息可能已发生改变，请注意甄别。&lt;/p></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            &lt;/p></span><span class=\"token template-punctuation string\">`</span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">return</span> addData</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span></pre></td></tr></table></figure>",
            "tags": [
                "记录",
                "shokaX",
                "插件"
            ]
        }
    ]
}